/*•••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••	Copyright © 1996-1997 Wicked Cyril		При использовании исходных текстов SDK указание Copyright © 1996-1997 Wicked Cyril		обязательно.		Так же при генерации писем обязательно упоминание название пакета Ravel в tearline.				Ravel SDK поставляется в виде "as is". Автор не несет ответственности за		несовместимость Plug-Ins в будущих версиях RavelSHUFFLER при использовании		undewater приемов программирования.				Не существует НИКАКОЙ документации по Ravel SDK.		Так же автор пока отказался от распространения исходных текстов не только работы		с базой сообщений, но и старых релизов RavelQUILL.  •••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••*/#include <string.h>//#include <stdio.h>#include <A4Stuff.h>#include "ravel_msg_base.h"#include "Ravel_Prefs.h"#include "PascalStr.h"#include "strning.h"#include "Ravel_PlugIns.h"char	*invokers[] = {"CLEANER", NULL};void main (PlugsControlPtr plugcontrol){	long		res;	short		ownFile, oldRes, i;	Handle		h;	pktmsg		*m;	DateTimeRec	dtr;	char		stemp[128];	EnterCodeResource ();	switch (plugcontrol->opCode)	{	case plugWelcome:		//	StartUp call of plug-ins. We make order and init. prefs.				plugcontrol->putlog ('=', "<Cleaner " RAVELISA "> Installed.");		res = plugCustomLaunch | plugCustomNames;		break;		case plugCustomNames:			plugcontrol->misc.names.plugInvokeNames = invokers;		res = plugRetContinue;		break;		case plugCustomLaunch:	//	We ordered only one call - CLEANER				if (!strcasecmp (invokers[0], plugcontrol->misc.plugInvokeName))		{			if (!plugcontrol->base_bsy_check ())			{				plugcontrol->base_bsy_raise ();				plugcontrol->_Purge ();				plugcontrol->_Pack ();				plugcontrol->_Link ();				plugcontrol->base_bsy_clear ();			}			else				plugcontrol->putlog ('=', "Base busy.");			res = plugRetNoError;		}		else			res = plugRetWrongCustom;		break;		default:				//	We're ignoring all other opCodes							//	(by the way, it's impossible unordered calls)			res = plugRetContinue;		break;	}	plugcontrol->retCode = res;	ExitCodeResource ();	}