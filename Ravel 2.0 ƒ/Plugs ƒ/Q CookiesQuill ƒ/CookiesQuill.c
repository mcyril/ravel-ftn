/*•••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••	Copyright © 1996-1997 Cyril Moorzin		При использовании исходных текстов SDK указание Copyright © 1996-1997 Cyril Moorzin		обязательно.		Так же при генерации писем обязательно упоминание название пакета Ravel в tearline.				Ravel SDK поставляется в виде "as is". Автор не несет ответственности за		несовместимость Plug-Ins в будущих версиях RavelSHUFFLER при использовании		undewater приемов программирования.				Не существует НИКАКОЙ документации по Ravel SDK.		Так же автор пока отказался от распространения исходных текстов не только работы		с базой сообщений, но и старых релизов RavelQUILL.  •••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••*/#include <Sound.h>#include <string.h>#include <stdio.h>#include <A4Stuff.h>#include "ravel_msg_base.h"#include "Ravel_Prefs.h"#include "PascalStr.h"#include "Ravel_Quill_PlugIns.h"#include "Cookies.h"char		g_cookiesfile[128];char		g_prefix[128];void ReadTemplates (StringPtr prefname, PlugsQControlPtr plugcontrol);void main (PlugsQControlPtr plugcontrol){	AEDesc				restxt;	ProcessSerialNumber	psn;	OSErr				err;	long		res;	short		ownFile, oldRes, i;	Handle		h;		char		script[1024];	char		text[1024];	char		name[256];	Str255		plugcfg;		EnterCodeResource ();	switch (plugcontrol->opCode)	{	case plugWelcome:		//	StartUp call of plug-ins. We make order and init. prefs.				pStrCopy (plugcontrol->thisplugPath, plugcfg);		pStrConc (plugcfg, "\p.cfg", plugcfg);		g_cookiesfile[0] = 0;		g_prefix[0] = 0;		ReadTemplates (plugcfg, plugcontrol);		ReadCookies();				plugcontrol->putlog ('=', "<CookiesQuill " RAVELISA "> Installed.");		res = plugMsgBodyDone;		break;		case plugMsgBodyDone:				dealCookie(plugcontrol->messageIn->text);			default:				//	We're ignoring all other opCodes							//	(by the way, it's impossible unordered calls)			res = plugRetContinue;		break;	}		plugcontrol->retCode = res;		ExitCodeResource ();	}