//	¥	guicode.c#include "PyPlug.h"#include "guicode.h"#include "DialogLib.h"#include "MoreDialogs.h"#include <extras.h>int	doSimpleListDlg(PyObject *py_list){	GrafPtr		oldPort;	DialogPtr	dlg;	short		i, size, res = -1;	short		homeResFile, oldResFile = CurResFile();		homeResFile = FSpOpenResFile (&gThisPlugSpec, fsRdPerm);	if (homeResFile != -1)	{		UseResFile(homeResFile);		GetPort(&oldPort);		dlg = MoreGetNewDialog (-128);				if (dlg)		{			ListHandle	lst;						SetPort(dlg);						SetDialogDefaultItem (dlg, 1);			SetDialogCancelItem (dlg, 2);			lst = InitListItem (dlg, 3, 0, lOnlyOne);						size = PyList_Size(py_list);			for (i = 0; i < size; i++)			{				PyObject *obj;				Str255	str;								obj = PyList_GetItem(py_list, i);				if (!PyString_Check(obj))				{					str[0] = 0;				}				else				{					memcpy(&str[1],	PyString_AsString(obj), str[0] = __min(255,PyString_Size(obj)));				}				PutStringToList(lst, str, putAtBottom);			}						ShowWindow(dlg);			LActivate(true, lst);			UpdateListItem(dlg, 3, lst);						do {					//			DebugStr("\phere we are");								ModalDialog (NULL, &res);								if (res == 3)				{					Point pt;					GetMouse(&pt);					if (LClick (pt, 0, lst))					{						FalseClick(dlg, 1);						res = 1;					}				}				else				if (res == 1)				{					Cell theCell;					SetPt(&theCell, 0, 0);					if (!LGetSelect(1, &theCell, lst))					{						SysBeep(10);						res = 0;					}				}							} while (res != 1 && res != 2);						if (res == 1)			{				Cell theCell;				SetPt(&theCell, 0, 0);				if (!LGetSelect(1, &theCell, lst))					res = -1;				else					res = theCell.v;			}			else			{				res = -1;			}			DisposeDialog(dlg);			LDispose(lst);			SetPort(oldPort);		}		else		{			SysBeep(10);		}			CloseResFile(homeResFile);		UseResFile(oldResFile);	}	else	{		SysBeep(10);	}		return res;}